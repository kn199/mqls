■アプリ停止
taskkill /F /T /IM "terminal.exe"

全部終了しちゃう。
ファイルパス書いても機能しないから一旦これで

■再起動
shutdown.exe /r /t 0

r: 再起動
t 0: 待ち時間0



■更新プログラム
rem 更新のスキャン及びダウンロード
usoclient ScanInstallWait

rem 更新プログラムのインストール
usoclient StartInstall

■アプリ起動
hoge.bat

-----------------------------
@echo off     //繰り返しコマンド実行されるのを避ける

rem アプリの起動 //コメント行

// app立ち上げ start + title　+ path
start "" "C:\Program Files (x86)\Titan FX MetaTrader 4-1\terminal.exe"

//rem アプリの停止
taskkill /F /T /IM　"C:\Program Files (x86)\Titan FX MetaTrader 4-1\terminal.exe"

/F：強制終了のオプション
/T：子プロセス含めて強制終了
/IM：PID ではなくて、アプリケーション（プログラム）の名前で強制終了するアプリケーション（プログラム）を指定する

// 終了
exit /B 0

■タスクスケジューラ
ファイル検索で
taskschd.msc

「タスクスケジューラライブラリ」を右クリックし、「新しいフォルダー」をクリックします。
タスクの作成をクリック

タイトルetc入力
トリガーからスケジュール入力
操作>新規>
プログラムの開始
参照>　.batを選択
必要であれば電子メールの送信

条件タブのチェックを全部外す

設定タブ
以下にチェック

・タスクを要求時に実行する
・タスクを停止するまでの期間: 1時間
・要求時に実行中のタスクが終了しない場合、タスクを強制的に停止する

タスクが既に実行中の場合に適用される規則:既存のインスタンスの停止


■起動・再起動のログ
「コントロールパネル」→「システムとセキュリティ」→「管理ツール」→「イベントビューアー」

Windowsログから「システム」を選択すればログが出てきます。


イベントID ソース 概要
「6005」 EventLog 起動時
「6006」 EventLog 正常にシャットダウン
「6008」 EventLog 正常にシャットダウンせずに終了
「6009」 EventLog 起動時にブート情報を記録
「12」 Kernel-General OS起動時
「13」 Kernel-General OSシャットダウン時


本当は、タスクスケジューラやbatでメール送信したかったが良いのが無い。
ログから追っていくことにする。
